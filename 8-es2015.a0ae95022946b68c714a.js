(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{"d9+q":function(t,e,n){"use strict";n.r(e);var o=n("ofXK"),i=n("FpXt"),r=n("tyNb"),c=n("3Pt+"),a=n("pLZG"),s=n("lJxs"),l=n("zp1y"),u=n("XNiG"),m=n("1G5W");function b(t){return"function"==typeof t}const p=Symbol("__destroy"),d=Symbol("__decoratorApplied");function g(t){return"string"==typeof t?Symbol(`__destroy__${t}`):p}function f(t){return!t[d]}function h(t){t[d]=!0}function C(t,e){t[e]||(t[e]=new u.a)}function y(t,e){t[e]&&(t[e].next(),t[e].complete(),t[e]=null)}function x(t){return t["\u0275cmp"]||t["\u0275dir"]}function v(t){return!!t.\u0275prov}function O(t){t&&b(t.unsubscribe)&&t.unsubscribe()}function S(t,{arrayName:e,checkProperties:n,blackList:o}){return function(){if(t&&t.call(this),y(this,g()),e)return i=this[e],void(Array.isArray(i)&&i.forEach(O));var i;if(n)for(const t in this)o&&o.includes(t)||O(this[t])}}function w(t={}){return e=>{v(e)?function(t,e){t.prototype.ngOnDestroy=S(t.prototype.ngOnDestroy,e),h(t)}(e,t):function(t,e){if(t.hasOwnProperty("__annotations__"))!function(t,e){const n=function(t){return t.hasOwnProperty("\u0275cmp")?"\u0275cmp":"\u0275dir"}(t),o=Object.getOwnPropertyDescriptor(t,n).get;Object.defineProperty(t,n,{get(){const t=o();return f(t)&&(t.onDestroy=S(t.onDestroy,e),h(t)),t}})}(t,e);else{const n=x(t);n.onDestroy=S(n.onDestroy,e),h(n)}}(e,t)}}function M(t,e){return n=>{const o=g(e);return"string"==typeof e?function(t,e,n){const o=t[e];if(!1===b(o))throw new Error(`${t.constructor.name} is using untilDestroyed but doesn't implement ${e}`);C(t,n),t[e]=function(){b(o)&&o.apply(this,arguments),y(this,n),t[e]=o}}(t,e,o):(function(t){const e=t.constructor;if(f(v(e)?e:x(e)))throw new Error("untilDestroyed operator cannot be used inside directives or components or providers that are not decorated with UntilDestroy decorator")}(t),C(t,o)),n.pipe(Object(m.a)(t[o]))}}var T=n("L8iz"),I=Object(T.a)((function(t,e){return Number(t)+Number(e)})),_=n("YyPD"),j=Object(_.a)(I,0),P=n("JVDt"),A=n("SqIO"),k=n("VRov"),B=Object(T.a)((function(t,e){return 1===t?Object(A.a)(e):Object(P.a)(t,Object(k.a)(t,[],e))})),G=B(1,Boolean),E=n("OEMQ"),L=n("gSdd"),N=n("ZMgP"),F=function(){function t(t,e){this.xf=e,this.f=t}return t.prototype["@@transducer/init"]=N.a.init,t.prototype["@@transducer/result"]=N.a.result,t.prototype["@@transducer/step"]=function(t,e){return this.xf["@@transducer/step"](t,this.f(e))},t}(),D=Object(T.a)((function(t,e){return new F(t,e)})),z=n("ZuG0"),V=Object(T.a)(Object(L.a)(["fantasy-land/map","map"],D,(function(t,e){switch(Object.prototype.toString.call(e)){case"[object Function]":return B(e.length,(function(){return t.call(this,e.apply(this,arguments))}));case"[object Object]":return Object(E.a)((function(n,o){return n[o]=t(e[o]),n}),{},Object(z.a)(e));default:return function(t,e){for(var n=0,o=e.length,i=Array(o);n<o;)i[n]=t(e[n]),n+=1;return i}(t,e)}}))),$=Object(T.a)((function(t,e){return"function"==typeof e["fantasy-land/ap"]?e["fantasy-land/ap"](t):"function"==typeof t.ap?t.ap(e):"function"==typeof t?function(n){return t(n)(e(n))}:Object(E.a)((function(t,n){return function(t,e){var n,o=(t=t||[]).length,i=(e=e||[]).length,r=[];for(n=0;n<o;)r[r.length]=t[n],n+=1;for(n=0;n<i;)r[r.length]=e[n],n+=1;return r}(t,V(n,e))}),[],t)})),q=Object(T.a)((function(t,e){var n=B(t,e);return B(t,(function(){return Object(E.a)($,V(n,arguments[0]),Array.prototype.slice.call(arguments,1))}))})),R=Object(A.a)((function(t){return q(t.length,t)})),J=Object(T.a)((function(t,e){return t||e})),W=Object(T.a)((function(t,e){return"[object Function]"===(n=Object.prototype.toString.call(t))||"[object AsyncFunction]"===n||"[object GeneratorFunction]"===n||"[object AsyncGeneratorFunction]"===n?function(){return t.apply(this,arguments)||e.apply(this,arguments)}:R(J)(t,e);var n})),X=n("Upr7"),H=n("SqYe"),U=B(1,W(X.a,H.a));const K={required:"\u8acb\u8f38\u5165\u6b64\u6b04",itemMinSelection:"\u8acb\u5b8c\u6210\u6b64\u5340\u7684\u9078\u53d6",itemMaxSelection:"\u6b64\u5340\u9078\u53d6\u4e86\u592a\u591a\u7684\u9805\u76ee"};class Q{static itemCount(t,e=t){return n=>{const o=X.a(n.value)||H.a(n.value)?0:j(Object.values(n.value));return o<e?{itemMinSelection:K.itemMinSelection}:o>t?{itemMaxSelection:K.itemMaxSelection}:null}}}var Y=n("fXoL");let Z=(()=>{class t{getFormErrors(t){const e={};return Object.entries(t.controls).forEach(t=>{const n=t[0],o=t[1];if(U(t[1].errors))e[n]=null;else{const t=Object.entries(o.errors)[0],i=t[0],r=t[1];e[n]="validationError"===i?t[1]:r.message||K[i]}}),e}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Y.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var tt=n("BF/v");let et=(()=>{class t{calcScore(t){const e=new tt.a;let n=0,o=0;return n+=this.getWinLossScore(t,"a"),o+=this.getWinLossScore(t,"b"),n*=this.applyGameItem(t,"a"),o*=this.applyGameItem(t,"b"),n+=this.addNewcomerAddition(t,"a"),o+=this.addNewcomerAddition(t,"b"),e.scoreA=n,e.scoreB=o,e.playerCount=t.playerCount,e.winner=t.winner,e.itemsA=t.itemsA,e.coinsA=t.coinsA,e.itemsB=t.itemsB,e.coinsB=t.coinsB,e}getWinLossScore(t,e){let n;return 2===t.playerCount&&(n={winner:t.winner,winScore:200,lossScore:100,deuceScore:100}),4===t.playerCount&&(n={winner:t.winner,winScore:400,lossScore:200,deuceScore:300}),(e===t.winner?n.winScore:0)+(e!==t.winner&&"deuce"!==t.winner?n.lossScore:0)+("deuce"===t.winner?n.deuceScore:0)}applyGameItem(t,e){const n="a"===e?t.itemsA:t.itemsB;let o=n.mushroom||0,i=n["golden-mushroom"]||0;const r=Math.max(0,(n["fake-item-box"]||0)+(("a"===e?t.itemsB:t.itemsA)["spiny-shell"]||0)+(-n.star||0));for(let a=0;a<r;a++)i?i--:o&&o--;let c=1;return c+=2*o,c+=3*i,c}addNewcomerAddition(t,e){const n={a:t.coinsA,b:t.coinsB}[e];return 50*(n["coin-50"]||0)+100*(n["coin-100"]||0)+200*(n["coin-200"]||0)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Y.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var nt=n("0IaG");class ot{constructor(){this.okLabel="\u53d6\u6d88",this.cancelLabel="\u53d6\u6d88"}}var it=n("NFeN");const rt=[[["",8,"dialog-title"]],[["",8,"dialog-content"]],[["",8,"dialog-action"]]],ct=[".dialog-title",".dialog-content",".dialog-action"];let at=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=Y.Hb({type:t,selectors:[["app-dialog-layout"]],ngContentSelectors:ct,decls:13,vars:0,consts:[["type","button","mat-dialog-close",""],["id","title"],[1,"dialog-body"],["align","end"]],template:function(t,e){1&t&&(Y.kc(rt),Y.Tb(0,"header"),Y.Tb(1,"button",0),Y.Tb(2,"mat-icon"),Y.yc(3,"close"),Y.Sb(),Y.Sb(),Y.Tb(4,"section",1),Y.jc(5),Y.Sb(),Y.Sb(),Y.Tb(6,"main"),Y.Tb(7,"section",2),Y.Tb(8,"mat-dialog-content"),Y.jc(9,1),Y.Sb(),Y.Sb(),Y.Sb(),Y.Tb(10,"footer"),Y.Tb(11,"mat-dialog-actions",3),Y.jc(12,2),Y.Sb(),Y.Sb())},directives:[nt.d,it.a,nt.e,nt.c],styles:["[_nghost-%COMP%]{display:flex;position:relative;flex-direction:column;height:100%}header[_ngcontent-%COMP%]{flex:0 0 20px;padding:20px 15px;font-size:20px;border-bottom:1px solid #d3d3d3}header[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{top:20px;right:20px;padding:0;margin:0;color:#696969;outline-style:none;background:none;border:none;position:absolute}main[_ngcontent-%COMP%]{min-width:200px;min-height:100px;flex:1 1;padding:15px 20px;overflow-y:auto;overflow-x:hidden}footer[_ngcontent-%COMP%]{padding:0 12px;flex:0 0 30px;border-top:1px solid #d3d3d3}hr[_ngcontent-%COMP%]{margin:0;width:100%;color:#e6e6e6}"]}),t})();var st=n("bTqV");function lt(t,e){if(1&t&&(Y.Tb(0,"p"),Y.yc(1),Y.Sb()),2&t){const t=e.$implicit;Y.Cb(1),Y.zc(t)}}function ut(t,e){if(1&t&&(Y.Tb(0,"button",6),Y.yc(1),Y.Sb()),2&t){const t=Y.fc();Y.Cb(1),Y.zc(t.config.cancelLabel)}}function mt(t,e){if(1&t){const t=Y.Ub();Y.Tb(0,"button",7),Y.bc("click",(function(){return Y.rc(t),Y.fc().ok()})),Y.yc(1),Y.Sb()}if(2&t){const t=Y.fc();Y.Cb(1),Y.zc(t.config.okLabel)}}let bt=(()=>{class t{constructor(t,e){this.dialogRef=t,this.messages=[],this.config=this.applyDefault(e),this.messages=(this.config.message||"").split("\n").filter(t=>t)}ok(){this.dialogRef.close(!0)}applyDefault(t){return Object.entries(t).filter(([t,e])=>void 0!==e).reduce((t,[e,n])=>(t[e]=n,t),new ot)}}return t.\u0275fac=function(e){return new(e||t)(Y.Nb(nt.g),Y.Nb(nt.a))},t.\u0275cmp=Y.Hb({type:t,selectors:[["app-confirm-dialog"]],decls:8,vars:4,consts:[[1,"dialog-title"],[1,"dialog-content"],[4,"ngFor","ngForOf"],[1,"dialog-action"],["mat-stroked-button","","mat-dialog-close","",4,"ngIf"],["mat-stroked-button","","color","primary",3,"click",4,"ngIf"],["mat-stroked-button","","mat-dialog-close",""],["mat-stroked-button","","color","primary",3,"click"]],template:function(t,e){1&t&&(Y.Tb(0,"app-dialog-layout"),Y.Tb(1,"div",0),Y.yc(2),Y.Sb(),Y.Tb(3,"div",1),Y.xc(4,lt,2,1,"p",2),Y.Sb(),Y.Tb(5,"div",3),Y.xc(6,ut,2,1,"button",4),Y.xc(7,mt,2,1,"button",5),Y.Sb(),Y.Sb()),2&t&&(Y.Cb(2),Y.Ac(" ",e.config.title," "),Y.Cb(2),Y.lc("ngForOf",e.messages),Y.Cb(2),Y.lc("ngIf",e.config.cancelLabel),Y.Cb(1),Y.lc("ngIf",e.config.okLabel))},directives:[at,o.j,o.k,st.a,nt.d],styles:[""]}),t})();var pt=n("Q28r"),dt=n("v8Ou"),gt=n("FdYD"),ft=n("kt0X"),ht=n("6LIv"),Ct=n("Wp6s"),yt=n("QibW"),xt=n("FKr1");let vt=(()=>{class t{constructor(){this.count=0,this.maxCount=0,this.name="",this.src="",this.countChange=new Y.o}changeCount(t){let e=(this.count||0)+t;e=this.maxCount?Math.min(this.maxCount,e):e,e=Math.max(0,e),e!==this.count&&(this.count=e,this.countChange.emit(this.count))}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=Y.Hb({type:t,selectors:[["app-game-item"]],inputs:{count:"count",maxCount:"maxCount",name:"name",src:"src"},outputs:{countChange:"countChange"},decls:10,vars:8,consts:[["matRipple","",1,"mario-item"],[1,"item-image-container",3,"click"],[3,"src","alt"],[1,"item-count"],[1,"item-name",3,"click"],["svgIcon","minus-square-outline",1,"minus-icon"],[1,"border-line"],[1,"shining-line"]],template:function(t,e){1&t&&(Y.Tb(0,"div",0),Y.Tb(1,"div",1),Y.bc("click",(function(){return e.changeCount(1)})),Y.Ob(2,"img",2),Y.Tb(3,"p",3),Y.yc(4),Y.Sb(),Y.Sb(),Y.Tb(5,"p",4),Y.bc("click",(function(){return e.changeCount(-1)})),Y.Ob(6,"mat-icon",5),Y.yc(7),Y.Sb(),Y.Ob(8,"div",6),Y.Ob(9,"div",7),Y.Sb()),2&t&&(Y.Eb("has-count",e.count),Y.Cb(2),Y.lc("src",e.src,Y.sc)("alt",e.name),Y.Cb(2),Y.zc(e.count?"\xd7"+e.count:""),Y.Cb(2),Y.Eb("disabled",!e.count),Y.Cb(1),Y.Ac(" ",e.name," "))},directives:[xt.c,it.a],styles:[".mario-item[_ngcontent-%COMP%]{width:92px;border-radius:8px;display:flex;flex-direction:column;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:relative;overflow:hidden}.mario-item[_ngcontent-%COMP%]   .item-image-container[_ngcontent-%COMP%]{width:100%;display:flex;position:relative;cursor:pointer}.mario-item[_ngcontent-%COMP%]   .item-image-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:54px;height:54px;margin:4px auto;-o-object-fit:contain;object-fit:contain}.mario-item[_ngcontent-%COMP%]   .item-image-container[_ngcontent-%COMP%]   .item-count[_ngcontent-%COMP%]{bottom:-6px;right:2px;margin:0;font-size:24px;letter-spacing:2px;color:#fff;position:absolute;text-shadow:-1.5px -1.5px 0 #000,1.5px -1.5px 0 #000,-1.5px 1.5px 0 #000,1.5px 1.5px 0 #000}.mario-item[_ngcontent-%COMP%]   .item-name[_ngcontent-%COMP%]{margin:0;padding:4px 0;font-size:16px;text-align:center;cursor:pointer}.mario-item[_ngcontent-%COMP%]   .item-name[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{width:12px;height:12px}.mario-item[_ngcontent-%COMP%]   .item-name[_ngcontent-%COMP%]   mat-icon.disabled[_ngcontent-%COMP%]{opacity:.2}.border-line[_ngcontent-%COMP%]{width:calc(100% - 4px);height:calc(100% - 4px);border:2px solid #4169e1;border-radius:8px;position:absolute;-webkit-clip-path:polygon(50% -50%,50% -50%,-50% 50%,-50% 50%);clip-path:polygon(50% -50%,50% -50%,-50% 50%,-50% 50%);pointer-events:none;transition:-webkit-clip-path .5s;transition:clip-path .5s;transition:clip-path .5s,-webkit-clip-path .5s;background-color:hsla(0,0%,87.8%,.2)}.has-count[_ngcontent-%COMP%]   .border-line[_ngcontent-%COMP%]{-webkit-clip-path:polygon(50% -50%,150% 50%,50% 150%,-50% 50%);clip-path:polygon(50% -50%,150% 50%,50% 150%,-50% 50%)}.shining-line[_ngcontent-%COMP%]{height:200%;width:40px;position:absolute;left:-40px;top:-100%;transform:rotate(45deg);transition-delay:.3s;transition:transform .6s;pointer-events:none;background:linear-gradient(90deg,hsla(0,0%,90.6%,0),hsla(0,0%,90.6%,.7) 50%,hsla(0,0%,90.6%,0))}.has-count[_ngcontent-%COMP%]   .shining-line[_ngcontent-%COMP%]{transform:rotate(45deg) translateX(170px)}"]}),t})();function Ot(t,e){if(1&t){const t=Y.Ub();Y.Tb(0,"app-game-item",1),Y.bc("countChange",(function(n){Y.rc(t);const o=e.$implicit,i=Y.fc();return i.ngModel&&(i.ngModel[o.id]=n)}))("countChange",(function(){Y.rc(t);const e=Y.fc();return e.onChange(e.ngModel)})),Y.Sb()}if(2&t){const t=e.$implicit,n=Y.fc();Y.lc("src",t.src)("name",t.name)("maxCount",n.maxItemCount)("count",n.ngModel&&n.ngModel[t.id])}}let St=(()=>{class t{constructor(){this.items=[],this.ngModel={},this.maxItemCount=0,this.ngModelChange=new Y.o}registerOnChange(t){this.onChange=t}registerOnTouched(t){}writeValue(t){this.ngModel=t}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=Y.Hb({type:t,selectors:[["app-game-item-select"]],inputs:{items:"items",ngModel:"ngModel",maxItemCount:"maxItemCount"},outputs:{ngModelChange:"ngModelChange"},features:[Y.Bb([{provide:c.e,multi:!0,useExisting:Object(Y.U)(()=>t)}])],decls:1,vars:1,consts:[[3,"src","name","maxCount","count","countChange",4,"ngFor","ngForOf"],[3,"src","name","maxCount","count","countChange"]],template:function(t,e){1&t&&Y.xc(0,Ot,1,4,"app-game-item",0),2&t&&Y.lc("ngForOf",e.items)},directives:[o.j,vt],styles:["[_nghost-%COMP%]{display:flex;flex-wrap:wrap}app-game-item[_ngcontent-%COMP%]:not(:last-child){margin-right:4px}"]}),t})();function wt(t,e){if(1&t&&(Y.Tb(0,"label",9),Y.yc(1),Y.Sb()),2&t){const t=Y.fc().ngLet;Y.Cb(1),Y.zc(t)}}function Mt(t,e){if(1&t&&(Y.Tb(0,"mat-card"),Y.Tb(1,"mat-card-title"),Y.yc(2,"\u8cfd\u5c40"),Y.Sb(),Y.Tb(3,"mat-card-content",5),Y.Tb(4,"mat-radio-group",6),Y.Tb(5,"mat-radio-button",7),Y.yc(6,"2\u4eba\u8cfd"),Y.Sb(),Y.Tb(7,"mat-radio-button",7),Y.yc(8,"4\u4eba\u8cfd"),Y.Sb(),Y.Sb(),Y.Sb(),Y.xc(9,wt,2,1,"label",8),Y.Sb()),2&t){const t=e.ngLet;Y.Eb("invalid-card",t),Y.Cb(5),Y.lc("value",2),Y.Cb(2),Y.lc("value",4),Y.Cb(2),Y.lc("ngIf",t)}}function Tt(t,e){if(1&t&&(Y.Tb(0,"label",9),Y.yc(1),Y.Sb()),2&t){const t=Y.fc().ngLet;Y.Cb(1),Y.zc(t)}}function It(t,e){if(1&t&&(Y.Tb(0,"mat-card"),Y.Tb(1,"mat-card-title"),Y.yc(2,"\u8f38\u8d0f"),Y.Sb(),Y.Tb(3,"mat-card-content",5),Y.Tb(4,"mat-radio-group",10),Y.Tb(5,"mat-radio-button",11),Y.yc(6,"A \u968a\u8d0f"),Y.Sb(),Y.Tb(7,"mat-radio-button",12),Y.yc(8,"B \u968a\u8d0f"),Y.Sb(),Y.Tb(9,"mat-radio-button",13),Y.yc(10,"\u5e73\u624b"),Y.Sb(),Y.Sb(),Y.Sb(),Y.xc(11,Tt,2,1,"label",8),Y.Sb()),2&t){const t=e.ngLet;Y.Eb("invalid-card",t),Y.Cb(11),Y.lc("ngIf",t)}}function _t(t,e){if(1&t&&(Y.Tb(0,"label",9),Y.yc(1),Y.Sb()),2&t){const t=Y.fc().ngLet;Y.Cb(1),Y.zc(t)}}function jt(t,e){if(1&t&&(Y.Tb(0,"mat-card"),Y.Tb(1,"mat-card-title"),Y.yc(2,"A\u968a - \u9053\u5177 "),Y.Tb(3,"span",14),Y.yc(4),Y.gc(5,"async"),Y.Sb(),Y.Sb(),Y.Tb(6,"mat-card-content"),Y.Ob(7,"app-game-item-select",15),Y.Sb(),Y.xc(8,_t,2,1,"label",8),Y.Sb()),2&t){const t=e.ngLet,n=Y.fc();Y.Eb("invalid-card",t),Y.Cb(3),Y.Eb("error-message",!n.formGroup.controls.itemsA.valid),Y.Cb(1),Y.Bc(" ",Y.hc(5,9,n.teamAItemsCount$),"/",n.availableItemsCount||"?"," "),Y.Cb(3),Y.lc("maxItemCount",n.availableItemsCount)("items",n.allGameItems),Y.Cb(1),Y.lc("ngIf",t)}}function Pt(t,e){if(1&t&&(Y.Tb(0,"label",9),Y.yc(1),Y.Sb()),2&t){const t=Y.fc().ngLet;Y.Cb(1),Y.zc(t)}}function At(t,e){if(1&t&&(Y.Tb(0,"mat-card"),Y.Tb(1,"mat-card-title"),Y.yc(2,"A\u968a - \u65b0\u670b\u53cb\u52a0\u6210 "),Y.Tb(3,"span",14),Y.yc(4),Y.gc(5,"async"),Y.Sb(),Y.Sb(),Y.Tb(6,"mat-card-content"),Y.Ob(7,"app-game-item-select",16),Y.Sb(),Y.xc(8,Pt,2,1,"label",8),Y.Sb()),2&t){const t=e.ngLet,n=Y.fc();Y.Eb("invalid-card",t),Y.Cb(3),Y.Eb("error-message",!n.formGroup.controls.coinsA.valid),Y.Cb(1),Y.Bc(" ",Y.hc(5,9,n.teamACoinCount$),"/",n.availableItemsCount||"?"," "),Y.Cb(3),Y.lc("maxItemCount",n.availableItemsCount)("items",n.allCoinTypes),Y.Cb(1),Y.lc("ngIf",t)}}function kt(t,e){if(1&t&&(Y.Tb(0,"label",9),Y.yc(1),Y.Sb()),2&t){const t=Y.fc().ngLet;Y.Cb(1),Y.zc(t)}}function Bt(t,e){if(1&t&&(Y.Tb(0,"mat-card"),Y.Tb(1,"mat-card-title"),Y.yc(2,"B\u968a - \u9053\u5177 "),Y.Tb(3,"span",14),Y.yc(4),Y.gc(5,"async"),Y.Sb(),Y.Sb(),Y.Tb(6,"mat-card-content"),Y.Ob(7,"app-game-item-select",17),Y.Sb(),Y.xc(8,kt,2,1,"label",8),Y.Sb()),2&t){const t=e.ngLet,n=Y.fc();Y.Eb("invalid-card",t),Y.Cb(3),Y.Eb("error-message",!n.formGroup.controls.itemsB.valid),Y.Cb(1),Y.Bc(" ",Y.hc(5,9,n.teamBItemsCount$),"/",n.availableItemsCount||"?"," "),Y.Cb(3),Y.lc("maxItemCount",n.availableItemsCount)("items",n.allGameItems),Y.Cb(1),Y.lc("ngIf",t)}}function Gt(t,e){if(1&t&&(Y.Tb(0,"label",9),Y.yc(1),Y.Sb()),2&t){const t=Y.fc().ngLet;Y.Cb(1),Y.zc(t)}}function Et(t,e){if(1&t&&(Y.Tb(0,"mat-card"),Y.Tb(1,"mat-card-title"),Y.yc(2,"B\u968a - \u65b0\u670b\u53cb\u52a0\u6210 "),Y.Tb(3,"span",14),Y.yc(4),Y.gc(5,"async"),Y.Sb(),Y.Sb(),Y.Tb(6,"mat-card-content"),Y.Ob(7,"app-game-item-select",18),Y.Sb(),Y.xc(8,Gt,2,1,"label",8),Y.Sb()),2&t){const t=e.ngLet,n=Y.fc();Y.Eb("invalid-card",t),Y.Cb(3),Y.Eb("error-message",!n.formGroup.controls.coinsB.valid),Y.Cb(1),Y.Bc(" ",Y.hc(5,9,n.teamBCoinCount$),"/",n.availableItemsCount||"?"," "),Y.Cb(3),Y.lc("items",n.allCoinTypes)("maxItemCount",n.formGroup.value.playerCount),Y.Cb(1),Y.lc("ngIf",t)}}const Lt=[{path:"",component:(()=>{let t=class{constructor(t,e,n,o,i,r){this.el=t,this.formBuilder=e,this.validationService=n,this.gameScoreCalcService=o,this.dialog=i,this.store=r,this.submitAttempt=!1,this.formErrors={},this.allGameItems=pt.b,this.allCoinTypes=pt.a,this.initForm(),this.nextGameInningNumber$=r.select(gt.a.selectNextInning)}initForm(){this.formGroup=this.formBuilder.group({playerCount:["",c.i.required],winner:["",c.i.required],itemsA:{},coinsA:{},itemsB:{},coinsB:{}}),this.formGroup.statusChanges.pipe(Object(a.a)(()=>this.submitAttempt),M(this)).subscribe(()=>this.updateErrors()),this.formGroup.get("playerCount").valueChanges.pipe(M(this)).subscribe(t=>this.updateItemCountValidator(t)),this.teamAItemsCount$=this.formGroup.get("itemsA").valueChanges.pipe(Object(s.a)(t=>this.getValueCount(t))),this.teamBItemsCount$=this.formGroup.get("itemsB").valueChanges.pipe(Object(s.a)(t=>this.getValueCount(t))),this.teamACoinCount$=this.formGroup.get("coinsA").valueChanges.pipe(Object(s.a)(t=>this.getValueCount(t))),this.teamBCoinCount$=this.formGroup.get("coinsB").valueChanges.pipe(Object(s.a)(t=>this.getValueCount(t)))}updateErrors(){return this.formErrors=this.validationService.getFormErrors(this.formGroup)}updateItemCountValidator(t){this.availableItemsCount=t,this.availableItemsCount&&(this.formGroup.get("itemsA").setValidators(Q.itemCount(this.availableItemsCount)),this.formGroup.get("itemsB").setValidators(Q.itemCount(this.availableItemsCount)),this.formGroup.get("coinsA").setValidators(Q.itemCount(this.availableItemsCount,0)),this.formGroup.get("coinsB").setValidators(Q.itemCount(this.availableItemsCount,0)),["itemsA","itemsB","coinsA","coinsB"].forEach(t=>this.formGroup.controls[t].updateValueAndValidity()),this.updateErrors())}getValueCount(t){return j(Object.values(t||{}))}onSubmit(){if(this.submitAttempt=!0,this.updateErrors(),this.formGroup.valid){const t=this.gameScoreCalcService.calcScore(this.formGroup.value);this.openDialog(t).afterClosed().pipe(Object(a.a)(G),Object(l.a)(this.nextGameInningNumber$),M(this)).subscribe(([e,n])=>this.saveScore(t,n))}else this.focusFirstError()}openDialog(t){return this.dialog.open(bt,{data:{title:"\u904a\u6232\u5206\u6578",message:`A\u968a: ${t.scoreA}\n`+`B\u968a: ${t.scoreB}\n`,okLabel:"\u9001\u51fa\u5206\u6578"}})}saveScore(t,e){t.time=new Date,t.id=(new Date).getTime(),t.inning=e,this.store.dispatch(dt.a.addScore({gameScore:t})),this.reset()}focusFirstError(){const t=this.el.nativeElement.querySelectorAll(".ng-invalid");t[0]&&(t[0].focus(),t[0].scrollIntoView())}reset(){this.initForm(),this.formErrors={},this.submitAttempt=!1}};return t.\u0275fac=function(e){return new(e||t)(Y.Nb(Y.l),Y.Nb(c.a),Y.Nb(Z),Y.Nb(et),Y.Nb(nt.b),Y.Nb(ft.h))},t.\u0275cmp=Y.Hb({type:t,selectors:[["app-input-score"]],decls:13,vars:9,consts:[[3,"formGroup","ngSubmit"],[3,"invalid-card",4,"ngLet"],[1,"submit-row"],["mat-stroked-button","","type","button",1,"reset-form",3,"click"],["type","submit","mat-raised-button",""],[1,"game-status"],["formControlName","playerCount"],[3,"value"],["class","error-message",4,"ngIf"],[1,"error-message"],["formControlName","winner"],["value","a"],["value","b"],["value","deuce"],[1,"items-count"],["formControlName","itemsA",3,"maxItemCount","items"],["formControlName","coinsA",3,"maxItemCount","items"],["formControlName","itemsB",3,"maxItemCount","items"],["formControlName","coinsB",3,"items","maxItemCount"]],template:function(t,e){1&t&&(Y.Tb(0,"form",0),Y.bc("ngSubmit",(function(){return e.onSubmit()})),Y.xc(1,Mt,10,5,"mat-card",1),Y.xc(2,It,12,3,"mat-card",1),Y.xc(3,jt,9,11,"mat-card",1),Y.xc(4,At,9,11,"mat-card",1),Y.xc(5,Bt,9,11,"mat-card",1),Y.xc(6,Et,9,11,"mat-card",1),Y.Tb(7,"div",2),Y.Tb(8,"button",3),Y.bc("click",(function(){return e.reset()})),Y.Tb(9,"mat-icon"),Y.yc(10,"refresh"),Y.Sb(),Y.Sb(),Y.Tb(11,"button",4),Y.yc(12,"\u8a08\u7b97\u5206\u6578"),Y.Sb(),Y.Sb(),Y.Sb()),2&t&&(Y.lc("formGroup",e.formGroup),Y.Cb(1),Y.lc("ngLet",e.submitAttempt&&e.formErrors.playerCount),Y.Cb(1),Y.lc("ngLet",e.submitAttempt&&e.formErrors.winner),Y.Cb(1),Y.lc("ngLet",e.submitAttempt&&e.formErrors.itemsA),Y.Cb(1),Y.lc("ngLet",e.submitAttempt&&e.formErrors.coinsA),Y.Cb(1),Y.lc("ngLet",e.submitAttempt&&e.formErrors.itemsB),Y.Cb(1),Y.lc("ngLet",e.submitAttempt&&e.formErrors.coinsB),Y.Cb(2),Y.wc("display",e.formGroup.pristine?"none":""))},directives:[c.j,c.g,c.c,ht.a,st.a,it.a,Ct.a,Ct.e,Ct.b,yt.b,c.f,c.b,yt.a,o.k,St],pipes:[o.b],styles:["mat-card[_ngcontent-%COMP%] + mat-card[_ngcontent-%COMP%]{margin-top:12px}[_nghost-%COMP%]     mat-radio-button label{font-size:24px;padding:6px}[_nghost-%COMP%]     mat-radio-button:not(:last-child) label{padding-right:16px}.game-status[_ngcontent-%COMP%]     mat-radio-button label{width:120px}.items-count[_ngcontent-%COMP%]{font-size:14px;line-height:33px;vertical-align:top;color:grey}.submit-row[_ngcontent-%COMP%]{width:100%;bottom:8px;margin-top:8px;display:flex;position:-webkit-sticky;position:sticky;pointer-events:none;justify-content:flex-end}.submit-row[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{pointer-events:auto}.submit-row[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:8px 12px;font-size:22px;color:#000}.submit-row[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:first-child{margin-right:12px}.submit-row[_ngcontent-%COMP%]   button[type=submit][_ngcontent-%COMP%]{background-color:#f0f8ff}"]}),t=function(t,e,n,o){var i,r=arguments.length,c=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,n,c):i(e,n))||c);return r>3&&c&&Object.defineProperty(e,n,c),c}([w()],t),t})()}];let Nt=(()=>{class t{}return t.\u0275mod=Y.Lb({type:t}),t.\u0275inj=Y.Kb({factory:function(e){return new(e||t)},imports:[[r.c.forChild(Lt)],r.c]}),t})();n.d(e,"InputScoreModule",(function(){return Ft}));let Ft=(()=>{class t{}return t.\u0275mod=Y.Lb({type:t}),t.\u0275inj=Y.Kb({factory:function(e){return new(e||t)},imports:[[o.c,i.a,Nt]]}),t})()}}]);