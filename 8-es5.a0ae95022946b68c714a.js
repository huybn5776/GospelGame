function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_unsupportedIterableToArray(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function _iterableToArrayLimit(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],o=!0,r=!1,i=void 0;try{for(var a,c=t[Symbol.iterator]();!(o=(a=c.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(s){r=!0,i=s}finally{try{o||null==c.return||c.return()}finally{if(r)throw i}}return n}}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{"d9+q":function(t,e,n){"use strict";n.r(e);var o=n("ofXK"),r=n("FpXt"),i=n("tyNb"),a=n("3Pt+"),c=n("pLZG"),s=n("lJxs"),u=n("zp1y"),l=n("XNiG"),b=n("1G5W");function m(t){return"function"==typeof t}var f=Symbol("__destroy"),p=Symbol("__decoratorApplied");function d(t){return"string"==typeof t?Symbol("__destroy__".concat(t)):f}function g(t){return!t[p]}function h(t){t[p]=!0}function C(t,e){t[e]||(t[e]=new l.a)}function y(t,e){t[e]&&(t[e].next(),t[e].complete(),t[e]=null)}function v(t){return t["\u0275cmp"]||t["\u0275dir"]}function x(t){return!!t.\u0275prov}function O(t){t&&m(t.unsubscribe)&&t.unsubscribe()}function S(t,e){var n=e.arrayName,o=e.checkProperties,r=e.blackList;return function(){if(t&&t.call(this),y(this,d()),n)return e=this[n],void(Array.isArray(e)&&e.forEach(O));var e;if(o)for(var i in this)r&&r.includes(i)||O(this[i])}}function _(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e){x(e)?function(t,e){t.prototype.ngOnDestroy=S(t.prototype.ngOnDestroy,e),h(t)}(e,t):function(t,e){if(t.hasOwnProperty("__annotations__"))!function(t,e){var n=function(t){return t.hasOwnProperty("\u0275cmp")?"\u0275cmp":"\u0275dir"}(t),o=Object.getOwnPropertyDescriptor(t,n).get;Object.defineProperty(t,n,{get:function(){var t=o();return g(t)&&(t.onDestroy=S(t.onDestroy,e),h(t)),t}})}(t,e);else{var n=v(t);n.onDestroy=S(n.onDestroy,e),h(n)}}(e,t)}}function w(t,e){return function(n){var o=d(e);return"string"==typeof e?function(t,e,n){var o=t[e];if(!1===m(o))throw new Error("".concat(t.constructor.name," is using untilDestroyed but doesn't implement ").concat(e));C(t,n),t[e]=function(){m(o)&&o.apply(this,arguments),y(this,n),t[e]=o}}(t,e,o):(function(t){var e=t.constructor;if(g(x(e)?e:v(e)))throw new Error("untilDestroyed operator cannot be used inside directives or components or providers that are not decorated with UntilDestroy decorator")}(t),C(t,o)),n.pipe(Object(b.a)(t[o]))}}var k,T,A,M=n("L8iz"),I=Object(M.a)((function(t,e){return Number(t)+Number(e)})),j=n("YyPD"),P=Object(j.a)(I,0),L=n("JVDt"),B=n("SqIO"),E=n("VRov"),G=Object(M.a)((function(t,e){return 1===t?Object(B.a)(e):Object(L.a)(t,Object(E.a)(t,[],e))})),N=G(1,Boolean),F=n("OEMQ"),D=n("gSdd"),z=n("ZMgP"),V=function(){function t(t,e){this.xf=e,this.f=t}return t.prototype["@@transducer/init"]=z.a.init,t.prototype["@@transducer/result"]=z.a.result,t.prototype["@@transducer/step"]=function(t,e){return this.xf["@@transducer/step"](t,this.f(e))},t}(),$=Object(M.a)((function(t,e){return new V(t,e)})),q=n("ZuG0"),R=Object(M.a)(Object(D.a)(["fantasy-land/map","map"],$,(function(t,e){switch(Object.prototype.toString.call(e)){case"[object Function]":return G(e.length,(function(){return t.call(this,e.apply(this,arguments))}));case"[object Object]":return Object(F.a)((function(n,o){return n[o]=t(e[o]),n}),{},Object(q.a)(e));default:return function(t,e){for(var n=0,o=e.length,r=Array(o);n<o;)r[n]=t(e[n]),n+=1;return r}(t,e)}}))),W=Object(M.a)((function(t,e){return"function"==typeof e["fantasy-land/ap"]?e["fantasy-land/ap"](t):"function"==typeof t.ap?t.ap(e):"function"==typeof t?function(n){return t(n)(e(n))}:Object(F.a)((function(t,n){return function(t,e){var n,o=(t=t||[]).length,r=(e=e||[]).length,i=[];for(n=0;n<o;)i[i.length]=t[n],n+=1;for(n=0;n<r;)i[i.length]=e[n],n+=1;return i}(t,R(n,e))}),[],t)})),H=Object(M.a)((function(t,e){var n=G(t,e);return G(t,(function(){return Object(F.a)(W,R(n,arguments[0]),Array.prototype.slice.call(arguments,1))}))})),J=Object(B.a)((function(t){return H(t.length,t)})),U=Object(M.a)((function(t,e){return t||e})),X=Object(M.a)((function(t,e){return"[object Function]"===(n=Object.prototype.toString.call(t))||"[object AsyncFunction]"===n||"[object GeneratorFunction]"===n||"[object AsyncGeneratorFunction]"===n?function(){return t.apply(this,arguments)||e.apply(this,arguments)}:J(U)(t,e);var n})),K=n("Upr7"),Q=n("SqYe"),Y=G(1,X(K.a,Q.a)),Z={required:"\u8acb\u8f38\u5165\u6b64\u6b04",itemMinSelection:"\u8acb\u5b8c\u6210\u6b64\u5340\u7684\u9078\u53d6",itemMaxSelection:"\u6b64\u5340\u9078\u53d6\u4e86\u592a\u591a\u7684\u9805\u76ee"},tt=function(){function t(){_classCallCheck(this,t)}return _createClass(t,null,[{key:"itemCount",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return function(n){var o=K.a(n.value)||Q.a(n.value)?0:P(Object.values(n.value));return o<e?{itemMinSelection:Z.itemMinSelection}:o>t?{itemMaxSelection:Z.itemMaxSelection}:null}}}]),t}(),et=n("fXoL"),nt=((k=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"getFormErrors",value:function(t){var e={};return Object.entries(t.controls).forEach((function(t){var n=t[0],o=t[1];if(Y(t[1].errors))e[n]=null;else{var r=Object.entries(o.errors)[0],i=r[0],a=r[1];e[n]="validationError"===i?r[1]:a.message||Z[i]}})),e}}]),t}()).\u0275fac=function(t){return new(t||k)},k.\u0275prov=et.Jb({token:k,factory:k.\u0275fac,providedIn:"root"}),k),ot=n("BF/v"),rt=((T=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"calcScore",value:function(t){var e=new ot.a,n=0,o=0;return n+=this.getWinLossScore(t,"a"),o+=this.getWinLossScore(t,"b"),n*=this.applyGameItem(t,"a"),o*=this.applyGameItem(t,"b"),n+=this.addNewcomerAddition(t,"a"),o+=this.addNewcomerAddition(t,"b"),e.scoreA=n,e.scoreB=o,e.playerCount=t.playerCount,e.winner=t.winner,e.itemsA=t.itemsA,e.coinsA=t.coinsA,e.itemsB=t.itemsB,e.coinsB=t.coinsB,e}},{key:"getWinLossScore",value:function(t,e){var n;return 2===t.playerCount&&(n={winner:t.winner,winScore:200,lossScore:100,deuceScore:100}),4===t.playerCount&&(n={winner:t.winner,winScore:400,lossScore:200,deuceScore:300}),(e===t.winner?n.winScore:0)+(e!==t.winner&&"deuce"!==t.winner?n.lossScore:0)+("deuce"===t.winner?n.deuceScore:0)}},{key:"applyGameItem",value:function(t,e){for(var n="a"===e?t.itemsA:t.itemsB,o=n.mushroom||0,r=n["golden-mushroom"]||0,i=Math.max(0,(n["fake-item-box"]||0)+(("a"===e?t.itemsB:t.itemsA)["spiny-shell"]||0)+(-n.star||0)),a=0;a<i;a++)r?r--:o&&o--;var c=1;return c+=2*o,c+=3*r}},{key:"addNewcomerAddition",value:function(t,e){var n={a:t.coinsA,b:t.coinsB}[e];return 50*(n["coin-50"]||0)+100*(n["coin-100"]||0)+200*(n["coin-200"]||0)}}]),t}()).\u0275fac=function(t){return new(t||T)},T.\u0275prov=et.Jb({token:T,factory:T.\u0275fac,providedIn:"root"}),T),it=n("0IaG"),at=function t(){_classCallCheck(this,t),this.okLabel="\u53d6\u6d88",this.cancelLabel="\u53d6\u6d88"},ct=n("NFeN"),st=[[["",8,"dialog-title"]],[["",8,"dialog-content"]],[["",8,"dialog-action"]]],ut=[".dialog-title",".dialog-content",".dialog-action"],lt=((A=function t(){_classCallCheck(this,t)}).\u0275fac=function(t){return new(t||A)},A.\u0275cmp=et.Hb({type:A,selectors:[["app-dialog-layout"]],ngContentSelectors:ut,decls:13,vars:0,consts:[["type","button","mat-dialog-close",""],["id","title"],[1,"dialog-body"],["align","end"]],template:function(t,e){1&t&&(et.kc(st),et.Tb(0,"header"),et.Tb(1,"button",0),et.Tb(2,"mat-icon"),et.yc(3,"close"),et.Sb(),et.Sb(),et.Tb(4,"section",1),et.jc(5),et.Sb(),et.Sb(),et.Tb(6,"main"),et.Tb(7,"section",2),et.Tb(8,"mat-dialog-content"),et.jc(9,1),et.Sb(),et.Sb(),et.Sb(),et.Tb(10,"footer"),et.Tb(11,"mat-dialog-actions",3),et.jc(12,2),et.Sb(),et.Sb())},directives:[it.d,ct.a,it.e,it.c],styles:["[_nghost-%COMP%]{display:flex;position:relative;flex-direction:column;height:100%}header[_ngcontent-%COMP%]{flex:0 0 20px;padding:20px 15px;font-size:20px;border-bottom:1px solid #d3d3d3}header[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{top:20px;right:20px;padding:0;margin:0;color:#696969;outline-style:none;background:none;border:none;position:absolute}main[_ngcontent-%COMP%]{min-width:200px;min-height:100px;flex:1 1;padding:15px 20px;overflow-y:auto;overflow-x:hidden}footer[_ngcontent-%COMP%]{padding:0 12px;flex:0 0 30px;border-top:1px solid #d3d3d3}hr[_ngcontent-%COMP%]{margin:0;width:100%;color:#e6e6e6}"]}),A),bt=n("bTqV");function mt(t,e){if(1&t&&(et.Tb(0,"p"),et.yc(1),et.Sb()),2&t){var n=e.$implicit;et.Cb(1),et.zc(n)}}function ft(t,e){if(1&t&&(et.Tb(0,"button",6),et.yc(1),et.Sb()),2&t){var n=et.fc();et.Cb(1),et.zc(n.config.cancelLabel)}}function pt(t,e){if(1&t){var n=et.Ub();et.Tb(0,"button",7),et.bc("click",(function(){return et.rc(n),et.fc().ok()})),et.yc(1),et.Sb()}if(2&t){var o=et.fc();et.Cb(1),et.zc(o.config.okLabel)}}var dt,gt,ht=((dt=function(){function t(e,n){_classCallCheck(this,t),this.dialogRef=e,this.messages=[],this.config=this.applyDefault(n),this.messages=(this.config.message||"").split("\n").filter((function(t){return t}))}return _createClass(t,[{key:"ok",value:function(){this.dialogRef.close(!0)}},{key:"applyDefault",value:function(t){return Object.entries(t).filter((function(t){var e=_slicedToArray(t,2);return e[0],void 0!==e[1]})).reduce((function(t,e){var n=_slicedToArray(e,2),o=n[0],r=n[1];return t[o]=r,t}),new at)}}]),t}()).\u0275fac=function(t){return new(t||dt)(et.Nb(it.g),et.Nb(it.a))},dt.\u0275cmp=et.Hb({type:dt,selectors:[["app-confirm-dialog"]],decls:8,vars:4,consts:[[1,"dialog-title"],[1,"dialog-content"],[4,"ngFor","ngForOf"],[1,"dialog-action"],["mat-stroked-button","","mat-dialog-close","",4,"ngIf"],["mat-stroked-button","","color","primary",3,"click",4,"ngIf"],["mat-stroked-button","","mat-dialog-close",""],["mat-stroked-button","","color","primary",3,"click"]],template:function(t,e){1&t&&(et.Tb(0,"app-dialog-layout"),et.Tb(1,"div",0),et.yc(2),et.Sb(),et.Tb(3,"div",1),et.xc(4,mt,2,1,"p",2),et.Sb(),et.Tb(5,"div",3),et.xc(6,ft,2,1,"button",4),et.xc(7,pt,2,1,"button",5),et.Sb(),et.Sb()),2&t&&(et.Cb(2),et.Ac(" ",e.config.title," "),et.Cb(2),et.lc("ngForOf",e.messages),et.Cb(2),et.lc("ngIf",e.config.cancelLabel),et.Cb(1),et.lc("ngIf",e.config.okLabel))},directives:[lt,o.j,o.k,bt.a,it.d],styles:[""]}),dt),Ct=n("Q28r"),yt=n("v8Ou"),vt=n("FdYD"),xt=n("kt0X"),Ot=n("6LIv"),St=n("Wp6s"),_t=n("QibW"),wt=n("FKr1"),kt=((gt=function(){function t(){_classCallCheck(this,t),this.count=0,this.maxCount=0,this.name="",this.src="",this.countChange=new et.o}return _createClass(t,[{key:"changeCount",value:function(t){var e=(this.count||0)+t;e=this.maxCount?Math.min(this.maxCount,e):e,(e=Math.max(0,e))!==this.count&&(this.count=e,this.countChange.emit(this.count))}}]),t}()).\u0275fac=function(t){return new(t||gt)},gt.\u0275cmp=et.Hb({type:gt,selectors:[["app-game-item"]],inputs:{count:"count",maxCount:"maxCount",name:"name",src:"src"},outputs:{countChange:"countChange"},decls:10,vars:8,consts:[["matRipple","",1,"mario-item"],[1,"item-image-container",3,"click"],[3,"src","alt"],[1,"item-count"],[1,"item-name",3,"click"],["svgIcon","minus-square-outline",1,"minus-icon"],[1,"border-line"],[1,"shining-line"]],template:function(t,e){1&t&&(et.Tb(0,"div",0),et.Tb(1,"div",1),et.bc("click",(function(){return e.changeCount(1)})),et.Ob(2,"img",2),et.Tb(3,"p",3),et.yc(4),et.Sb(),et.Sb(),et.Tb(5,"p",4),et.bc("click",(function(){return e.changeCount(-1)})),et.Ob(6,"mat-icon",5),et.yc(7),et.Sb(),et.Ob(8,"div",6),et.Ob(9,"div",7),et.Sb()),2&t&&(et.Eb("has-count",e.count),et.Cb(2),et.lc("src",e.src,et.sc)("alt",e.name),et.Cb(2),et.zc(e.count?"\xd7"+e.count:""),et.Cb(2),et.Eb("disabled",!e.count),et.Cb(1),et.Ac(" ",e.name," "))},directives:[wt.c,ct.a],styles:[".mario-item[_ngcontent-%COMP%]{width:92px;border-radius:8px;display:flex;flex-direction:column;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:relative;overflow:hidden}.mario-item[_ngcontent-%COMP%]   .item-image-container[_ngcontent-%COMP%]{width:100%;display:flex;position:relative;cursor:pointer}.mario-item[_ngcontent-%COMP%]   .item-image-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:54px;height:54px;margin:4px auto;-o-object-fit:contain;object-fit:contain}.mario-item[_ngcontent-%COMP%]   .item-image-container[_ngcontent-%COMP%]   .item-count[_ngcontent-%COMP%]{bottom:-6px;right:2px;margin:0;font-size:24px;letter-spacing:2px;color:#fff;position:absolute;text-shadow:-1.5px -1.5px 0 #000,1.5px -1.5px 0 #000,-1.5px 1.5px 0 #000,1.5px 1.5px 0 #000}.mario-item[_ngcontent-%COMP%]   .item-name[_ngcontent-%COMP%]{margin:0;padding:4px 0;font-size:16px;text-align:center;cursor:pointer}.mario-item[_ngcontent-%COMP%]   .item-name[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{width:12px;height:12px}.mario-item[_ngcontent-%COMP%]   .item-name[_ngcontent-%COMP%]   mat-icon.disabled[_ngcontent-%COMP%]{opacity:.2}.border-line[_ngcontent-%COMP%]{width:calc(100% - 4px);height:calc(100% - 4px);border:2px solid #4169e1;border-radius:8px;position:absolute;-webkit-clip-path:polygon(50% -50%,50% -50%,-50% 50%,-50% 50%);clip-path:polygon(50% -50%,50% -50%,-50% 50%,-50% 50%);pointer-events:none;transition:-webkit-clip-path .5s;transition:clip-path .5s;transition:clip-path .5s,-webkit-clip-path .5s;background-color:hsla(0,0%,87.8%,.2)}.has-count[_ngcontent-%COMP%]   .border-line[_ngcontent-%COMP%]{-webkit-clip-path:polygon(50% -50%,150% 50%,50% 150%,-50% 50%);clip-path:polygon(50% -50%,150% 50%,50% 150%,-50% 50%)}.shining-line[_ngcontent-%COMP%]{height:200%;width:40px;position:absolute;left:-40px;top:-100%;transform:rotate(45deg);transition-delay:.3s;transition:transform .6s;pointer-events:none;background:linear-gradient(90deg,hsla(0,0%,90.6%,0),hsla(0,0%,90.6%,.7) 50%,hsla(0,0%,90.6%,0))}.has-count[_ngcontent-%COMP%]   .shining-line[_ngcontent-%COMP%]{transform:rotate(45deg) translateX(170px)}"]}),gt);function Tt(t,e){if(1&t){var n=et.Ub();et.Tb(0,"app-game-item",1),et.bc("countChange",(function(t){et.rc(n);var o=e.$implicit,r=et.fc();return r.ngModel&&(r.ngModel[o.id]=t)}))("countChange",(function(){et.rc(n);var t=et.fc();return t.onChange(t.ngModel)})),et.Sb()}if(2&t){var o=e.$implicit,r=et.fc();et.lc("src",o.src)("name",o.name)("maxCount",r.maxItemCount)("count",r.ngModel&&r.ngModel[o.id])}}var At,Mt=((At=function(){function t(){_classCallCheck(this,t),this.items=[],this.ngModel={},this.maxItemCount=0,this.ngModelChange=new et.o}return _createClass(t,[{key:"registerOnChange",value:function(t){this.onChange=t}},{key:"registerOnTouched",value:function(t){}},{key:"writeValue",value:function(t){this.ngModel=t}}]),t}()).\u0275fac=function(t){return new(t||At)},At.\u0275cmp=et.Hb({type:At,selectors:[["app-game-item-select"]],inputs:{items:"items",ngModel:"ngModel",maxItemCount:"maxItemCount"},outputs:{ngModelChange:"ngModelChange"},features:[et.Bb([{provide:a.e,multi:!0,useExisting:Object(et.U)((function(){return At}))}])],decls:1,vars:1,consts:[[3,"src","name","maxCount","count","countChange",4,"ngFor","ngForOf"],[3,"src","name","maxCount","count","countChange"]],template:function(t,e){1&t&&et.xc(0,Tt,1,4,"app-game-item",0),2&t&&et.lc("ngForOf",e.items)},directives:[o.j,kt],styles:["[_nghost-%COMP%]{display:flex;flex-wrap:wrap}app-game-item[_ngcontent-%COMP%]:not(:last-child){margin-right:4px}"]}),At);function It(t,e){if(1&t&&(et.Tb(0,"label",9),et.yc(1),et.Sb()),2&t){var n=et.fc().ngLet;et.Cb(1),et.zc(n)}}function jt(t,e){if(1&t&&(et.Tb(0,"mat-card"),et.Tb(1,"mat-card-title"),et.yc(2,"\u8cfd\u5c40"),et.Sb(),et.Tb(3,"mat-card-content",5),et.Tb(4,"mat-radio-group",6),et.Tb(5,"mat-radio-button",7),et.yc(6,"2\u4eba\u8cfd"),et.Sb(),et.Tb(7,"mat-radio-button",7),et.yc(8,"4\u4eba\u8cfd"),et.Sb(),et.Sb(),et.Sb(),et.xc(9,It,2,1,"label",8),et.Sb()),2&t){var n=e.ngLet;et.Eb("invalid-card",n),et.Cb(5),et.lc("value",2),et.Cb(2),et.lc("value",4),et.Cb(2),et.lc("ngIf",n)}}function Pt(t,e){if(1&t&&(et.Tb(0,"label",9),et.yc(1),et.Sb()),2&t){var n=et.fc().ngLet;et.Cb(1),et.zc(n)}}function Lt(t,e){if(1&t&&(et.Tb(0,"mat-card"),et.Tb(1,"mat-card-title"),et.yc(2,"\u8f38\u8d0f"),et.Sb(),et.Tb(3,"mat-card-content",5),et.Tb(4,"mat-radio-group",10),et.Tb(5,"mat-radio-button",11),et.yc(6,"A \u968a\u8d0f"),et.Sb(),et.Tb(7,"mat-radio-button",12),et.yc(8,"B \u968a\u8d0f"),et.Sb(),et.Tb(9,"mat-radio-button",13),et.yc(10,"\u5e73\u624b"),et.Sb(),et.Sb(),et.Sb(),et.xc(11,Pt,2,1,"label",8),et.Sb()),2&t){var n=e.ngLet;et.Eb("invalid-card",n),et.Cb(11),et.lc("ngIf",n)}}function Bt(t,e){if(1&t&&(et.Tb(0,"label",9),et.yc(1),et.Sb()),2&t){var n=et.fc().ngLet;et.Cb(1),et.zc(n)}}function Et(t,e){if(1&t&&(et.Tb(0,"mat-card"),et.Tb(1,"mat-card-title"),et.yc(2,"A\u968a - \u9053\u5177 "),et.Tb(3,"span",14),et.yc(4),et.gc(5,"async"),et.Sb(),et.Sb(),et.Tb(6,"mat-card-content"),et.Ob(7,"app-game-item-select",15),et.Sb(),et.xc(8,Bt,2,1,"label",8),et.Sb()),2&t){var n=e.ngLet,o=et.fc();et.Eb("invalid-card",n),et.Cb(3),et.Eb("error-message",!o.formGroup.controls.itemsA.valid),et.Cb(1),et.Bc(" ",et.hc(5,9,o.teamAItemsCount$),"/",o.availableItemsCount||"?"," "),et.Cb(3),et.lc("maxItemCount",o.availableItemsCount)("items",o.allGameItems),et.Cb(1),et.lc("ngIf",n)}}function Gt(t,e){if(1&t&&(et.Tb(0,"label",9),et.yc(1),et.Sb()),2&t){var n=et.fc().ngLet;et.Cb(1),et.zc(n)}}function Nt(t,e){if(1&t&&(et.Tb(0,"mat-card"),et.Tb(1,"mat-card-title"),et.yc(2,"A\u968a - \u65b0\u670b\u53cb\u52a0\u6210 "),et.Tb(3,"span",14),et.yc(4),et.gc(5,"async"),et.Sb(),et.Sb(),et.Tb(6,"mat-card-content"),et.Ob(7,"app-game-item-select",16),et.Sb(),et.xc(8,Gt,2,1,"label",8),et.Sb()),2&t){var n=e.ngLet,o=et.fc();et.Eb("invalid-card",n),et.Cb(3),et.Eb("error-message",!o.formGroup.controls.coinsA.valid),et.Cb(1),et.Bc(" ",et.hc(5,9,o.teamACoinCount$),"/",o.availableItemsCount||"?"," "),et.Cb(3),et.lc("maxItemCount",o.availableItemsCount)("items",o.allCoinTypes),et.Cb(1),et.lc("ngIf",n)}}function Ft(t,e){if(1&t&&(et.Tb(0,"label",9),et.yc(1),et.Sb()),2&t){var n=et.fc().ngLet;et.Cb(1),et.zc(n)}}function Dt(t,e){if(1&t&&(et.Tb(0,"mat-card"),et.Tb(1,"mat-card-title"),et.yc(2,"B\u968a - \u9053\u5177 "),et.Tb(3,"span",14),et.yc(4),et.gc(5,"async"),et.Sb(),et.Sb(),et.Tb(6,"mat-card-content"),et.Ob(7,"app-game-item-select",17),et.Sb(),et.xc(8,Ft,2,1,"label",8),et.Sb()),2&t){var n=e.ngLet,o=et.fc();et.Eb("invalid-card",n),et.Cb(3),et.Eb("error-message",!o.formGroup.controls.itemsB.valid),et.Cb(1),et.Bc(" ",et.hc(5,9,o.teamBItemsCount$),"/",o.availableItemsCount||"?"," "),et.Cb(3),et.lc("maxItemCount",o.availableItemsCount)("items",o.allGameItems),et.Cb(1),et.lc("ngIf",n)}}function zt(t,e){if(1&t&&(et.Tb(0,"label",9),et.yc(1),et.Sb()),2&t){var n=et.fc().ngLet;et.Cb(1),et.zc(n)}}function Vt(t,e){if(1&t&&(et.Tb(0,"mat-card"),et.Tb(1,"mat-card-title"),et.yc(2,"B\u968a - \u65b0\u670b\u53cb\u52a0\u6210 "),et.Tb(3,"span",14),et.yc(4),et.gc(5,"async"),et.Sb(),et.Sb(),et.Tb(6,"mat-card-content"),et.Ob(7,"app-game-item-select",18),et.Sb(),et.xc(8,zt,2,1,"label",8),et.Sb()),2&t){var n=e.ngLet,o=et.fc();et.Eb("invalid-card",n),et.Cb(3),et.Eb("error-message",!o.formGroup.controls.coinsB.valid),et.Cb(1),et.Bc(" ",et.hc(5,9,o.teamBCoinCount$),"/",o.availableItemsCount||"?"," "),et.Cb(3),et.lc("items",o.allCoinTypes)("maxItemCount",o.formGroup.value.playerCount),et.Cb(1),et.lc("ngIf",n)}}var $t,qt,Rt=[{path:"",component:($t=function(){function t(e,n,o,r,i,a){_classCallCheck(this,t),this.el=e,this.formBuilder=n,this.validationService=o,this.gameScoreCalcService=r,this.dialog=i,this.store=a,this.submitAttempt=!1,this.formErrors={},this.allGameItems=Ct.b,this.allCoinTypes=Ct.a,this.initForm(),this.nextGameInningNumber$=a.select(vt.a.selectNextInning)}return _createClass(t,[{key:"initForm",value:function(){var t=this;this.formGroup=this.formBuilder.group({playerCount:["",a.i.required],winner:["",a.i.required],itemsA:{},coinsA:{},itemsB:{},coinsB:{}}),this.formGroup.statusChanges.pipe(Object(c.a)((function(){return t.submitAttempt})),w(this)).subscribe((function(){return t.updateErrors()})),this.formGroup.get("playerCount").valueChanges.pipe(w(this)).subscribe((function(e){return t.updateItemCountValidator(e)})),this.teamAItemsCount$=this.formGroup.get("itemsA").valueChanges.pipe(Object(s.a)((function(e){return t.getValueCount(e)}))),this.teamBItemsCount$=this.formGroup.get("itemsB").valueChanges.pipe(Object(s.a)((function(e){return t.getValueCount(e)}))),this.teamACoinCount$=this.formGroup.get("coinsA").valueChanges.pipe(Object(s.a)((function(e){return t.getValueCount(e)}))),this.teamBCoinCount$=this.formGroup.get("coinsB").valueChanges.pipe(Object(s.a)((function(e){return t.getValueCount(e)})))}},{key:"updateErrors",value:function(){return this.formErrors=this.validationService.getFormErrors(this.formGroup)}},{key:"updateItemCountValidator",value:function(t){var e=this;this.availableItemsCount=t,this.availableItemsCount&&(this.formGroup.get("itemsA").setValidators(tt.itemCount(this.availableItemsCount)),this.formGroup.get("itemsB").setValidators(tt.itemCount(this.availableItemsCount)),this.formGroup.get("coinsA").setValidators(tt.itemCount(this.availableItemsCount,0)),this.formGroup.get("coinsB").setValidators(tt.itemCount(this.availableItemsCount,0)),["itemsA","itemsB","coinsA","coinsB"].forEach((function(t){return e.formGroup.controls[t].updateValueAndValidity()})),this.updateErrors())}},{key:"getValueCount",value:function(t){return P(Object.values(t||{}))}},{key:"onSubmit",value:function(){var t=this;if(this.submitAttempt=!0,this.updateErrors(),this.formGroup.valid){var e=this.gameScoreCalcService.calcScore(this.formGroup.value);this.openDialog(e).afterClosed().pipe(Object(c.a)(N),Object(u.a)(this.nextGameInningNumber$),w(this)).subscribe((function(n){var o=_slicedToArray(n,2),r=(o[0],o[1]);return t.saveScore(e,r)}))}else this.focusFirstError()}},{key:"openDialog",value:function(t){return this.dialog.open(ht,{data:{title:"\u904a\u6232\u5206\u6578",message:"A\u968a: ".concat(t.scoreA,"\n")+"B\u968a: ".concat(t.scoreB,"\n"),okLabel:"\u9001\u51fa\u5206\u6578"}})}},{key:"saveScore",value:function(t,e){t.time=new Date,t.id=(new Date).getTime(),t.inning=e,this.store.dispatch(yt.a.addScore({gameScore:t})),this.reset()}},{key:"focusFirstError",value:function(){var t=this.el.nativeElement.querySelectorAll(".ng-invalid");t[0]&&(t[0].focus(),t[0].scrollIntoView())}},{key:"reset",value:function(){this.initForm(),this.formErrors={},this.submitAttempt=!1}}]),t}(),$t.\u0275fac=function(t){return new(t||$t)(et.Nb(et.l),et.Nb(a.a),et.Nb(nt),et.Nb(rt),et.Nb(it.b),et.Nb(xt.h))},$t.\u0275cmp=et.Hb({type:$t,selectors:[["app-input-score"]],decls:13,vars:9,consts:[[3,"formGroup","ngSubmit"],[3,"invalid-card",4,"ngLet"],[1,"submit-row"],["mat-stroked-button","","type","button",1,"reset-form",3,"click"],["type","submit","mat-raised-button",""],[1,"game-status"],["formControlName","playerCount"],[3,"value"],["class","error-message",4,"ngIf"],[1,"error-message"],["formControlName","winner"],["value","a"],["value","b"],["value","deuce"],[1,"items-count"],["formControlName","itemsA",3,"maxItemCount","items"],["formControlName","coinsA",3,"maxItemCount","items"],["formControlName","itemsB",3,"maxItemCount","items"],["formControlName","coinsB",3,"items","maxItemCount"]],template:function(t,e){1&t&&(et.Tb(0,"form",0),et.bc("ngSubmit",(function(){return e.onSubmit()})),et.xc(1,jt,10,5,"mat-card",1),et.xc(2,Lt,12,3,"mat-card",1),et.xc(3,Et,9,11,"mat-card",1),et.xc(4,Nt,9,11,"mat-card",1),et.xc(5,Dt,9,11,"mat-card",1),et.xc(6,Vt,9,11,"mat-card",1),et.Tb(7,"div",2),et.Tb(8,"button",3),et.bc("click",(function(){return e.reset()})),et.Tb(9,"mat-icon"),et.yc(10,"refresh"),et.Sb(),et.Sb(),et.Tb(11,"button",4),et.yc(12,"\u8a08\u7b97\u5206\u6578"),et.Sb(),et.Sb(),et.Sb()),2&t&&(et.lc("formGroup",e.formGroup),et.Cb(1),et.lc("ngLet",e.submitAttempt&&e.formErrors.playerCount),et.Cb(1),et.lc("ngLet",e.submitAttempt&&e.formErrors.winner),et.Cb(1),et.lc("ngLet",e.submitAttempt&&e.formErrors.itemsA),et.Cb(1),et.lc("ngLet",e.submitAttempt&&e.formErrors.coinsA),et.Cb(1),et.lc("ngLet",e.submitAttempt&&e.formErrors.itemsB),et.Cb(1),et.lc("ngLet",e.submitAttempt&&e.formErrors.coinsB),et.Cb(2),et.wc("display",e.formGroup.pristine?"none":""))},directives:[a.j,a.g,a.c,Ot.a,bt.a,ct.a,St.a,St.e,St.b,_t.b,a.f,a.b,_t.a,o.k,Mt],pipes:[o.b],styles:["mat-card[_ngcontent-%COMP%] + mat-card[_ngcontent-%COMP%]{margin-top:12px}[_nghost-%COMP%]     mat-radio-button label{font-size:24px;padding:6px}[_nghost-%COMP%]     mat-radio-button:not(:last-child) label{padding-right:16px}.game-status[_ngcontent-%COMP%]     mat-radio-button label{width:120px}.items-count[_ngcontent-%COMP%]{font-size:14px;line-height:33px;vertical-align:top;color:grey}.submit-row[_ngcontent-%COMP%]{width:100%;bottom:8px;margin-top:8px;display:flex;position:-webkit-sticky;position:sticky;pointer-events:none;justify-content:flex-end}.submit-row[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{pointer-events:auto}.submit-row[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:8px 12px;font-size:22px;color:#000}.submit-row[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:first-child{margin-right:12px}.submit-row[_ngcontent-%COMP%]   button[type=submit][_ngcontent-%COMP%]{background-color:#f0f8ff}"]}),$t=function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a}([_()],$t))}],Wt=((qt=function t(){_classCallCheck(this,t)}).\u0275mod=et.Lb({type:qt}),qt.\u0275inj=et.Kb({factory:function(t){return new(t||qt)},imports:[[i.c.forChild(Rt)],i.c]}),qt);n.d(e,"InputScoreModule",(function(){return Jt}));var Ht,Jt=((Ht=function t(){_classCallCheck(this,t)}).\u0275mod=et.Lb({type:Ht}),Ht.\u0275inj=et.Kb({factory:function(t){return new(t||Ht)},imports:[[o.c,r.a,Wt]]}),Ht)}}]);